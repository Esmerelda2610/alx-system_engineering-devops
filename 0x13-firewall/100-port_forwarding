#                                                                                                       2 # rules.before
  3 #
  4 # Rules that should be run before the ufw command line added rules. Custom
  5 # rules should be added to one of these chains:
  6 #   ufw-before-input
  7 #   ufw-before-output
  8 #   ufw-before-forward
  9 #
 10
 11 # Don't delete these required lines, otherwise there will be errors
 12 *filter
 13 :ufw-before-input - [0:0]
 14 :ufw-before-output - [0:0]
 15 :ufw-before-forward - [0:0]
 16 :ufw-not-local - [0:0]
 17 # End required lines
 18
 19
 20 # allow all on loopback
 21 -A ufw-before-input -i lo -j ACCEPT
 22 -A ufw-before-output -o lo -j ACCEPT
 23
 24 # quickly process packets for which we already have a connection
 25 -A ufw-before-input -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
 26 -A ufw-before-output -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
 27 -A ufw-before-forward -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
 28
 29 # drop INVALID packets (logs these in loglevel medium and higher)
 30 -A ufw-before-input -m conntrack --ctstate INVALID -j ufw-logging-deny
 31 -A ufw-before-input -m conntrack --ctstate INVALID -j DROP
 32
 33 # ok icmp codes for INPUT
 34 -A ufw-before-input -p icmp --icmp-type destination-unreachable -j ACCEPT
 35 -A ufw-before-input -p icmp --icmp-type time-exceeded -j ACCEPT
 36 -A ufw-before-input -p icmp --icmp-type parameter-problem -j ACCEPT
 37 -A ufw-before-input -p icmp --icmp-type echo-request -j ACCEPT
 38
 39 # ok icmp code for FORWARD
 40 -A ufw-before-forward -p icmp --icmp-type destination-unreachable -j ACCEPT
 41 -A ufw-before-forward -p icmp --icmp-type time-exceeded -j ACCEPT
 42 -A ufw-before-forward -p icmp --icmp-type parameter-problem -j ACCEPT
 43 -A ufw-before-forward -p icmp --icmp-type echo-request -j ACCEPT
 44
"100-port_forwarding" 79L, 2633C                       
